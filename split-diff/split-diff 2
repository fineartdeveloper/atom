# php_value max_execution_time 0
# php_value max_input_time -1
# php_value memory_limit 1024M
# php_value output_buffering 1024M

# AddHandler application/x-httpd-php5 .php

# BLOCKIP
Order Deny,Allow
Deny from 157.39.183.2
Deny from 103.40.192.170
# ENDBLOCKIP


<IfModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file .(html?|txt|css|js|php|pl)$
  mod_gzip_item_include handler ^cgi-script$
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_include mime ^application/x-javascript.*
  mod_gzip_item_exclude mime ^image/.*
  mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</IfModule>


<IfModule mod_deflate.c>
  <IfModule mod_setenvif.c>
    <IfModule mod_headers.c>
      SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
      RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
    </IfModule>
  </IfModule>

  <IfModule mod_filter.c>
    AddOutputFilterByType DEFLATE "application/atom+xml" \
                                  "application/javascript" \
                                  "application/json" \
                                  "application/ld+json" \
                                  "application/manifest+json" \
                                  "application/rdf+xml" \
                                  "application/rss+xml" \
                                  "application/schema+json" \
                                  "application/vnd.geo+json" \
                                  "application/vnd.ms-fontobject" \
                                  "application/x-font-ttf" \
                                  "application/x-javascript" \
                                  "application/x-web-app-manifest+json" \
                                  "application/xhtml+xml" \
                                  "application/xml" \
                                  "font/eot" \
                                  "font/opentype" \
                                  "image/bmp" \
                                  "image/svg+xml" \
                                  "image/vnd.microsoft.icon" \
                                  "image/x-icon" \
                                  "text/cache-manifest" \
                                  "text/css" \
                                  "text/html" \
                                  "text/javascript" \
                                  "text/plain" \
                                  "text/vcard" \
                                  "text/vnd.rim.location.xloc" \
                                  "text/vtt" \
                                  "text/x-component" \
                                  "text/x-cross-domain-policy" \
                                  "text/xml"
  </IfModule>

  <IfModule mod_mime.c>
    AddEncoding gzip svgz
  </IfModule>

  # For Olders Browsers Which Can't Handle Compression
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</IfModule>


<IfModule mod_headers.c>
    Header unset ETag
</IfModule>


FileETag None


<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresDefault                                      "access plus 1 day"

    ExpiresByType text/css                              "access plus 0 seconds"

    ExpiresByType application/atom+xml                  "access plus 1 hour"
    ExpiresByType application/rdf+xml                   "access plus 1 hour"
    ExpiresByType application/rss+xml                   "access plus 1 hour"

    ExpiresByType application/json                      "access plus 0 seconds"
    ExpiresByType application/ld+json                   "access plus 0 seconds"
    ExpiresByType application/schema+json               "access plus 0 seconds"
    ExpiresByType application/vnd.geo+json              "access plus 0 seconds"
    ExpiresByType application/xml                       "access plus 0 seconds"
    ExpiresByType text/xml                              "access plus 0 seconds"

    ExpiresByType image/vnd.microsoft.icon              "access plus 1 week"
    ExpiresByType image/x-icon                          "access plus 1 week"

    ExpiresByType text/html                             "access plus 0 seconds"

    ExpiresByType application/javascript                "access plus 0 seconds"
    ExpiresByType application/x-javascript              "access plus 0 seconds"
    ExpiresByType text/javascript                       "access plus 0 seconds"

    ExpiresByType application/manifest+json             "access plus 0 seconds"
    ExpiresByType application/x-web-app-manifest+json   "access plus 0 seconds"
    ExpiresByType text/cache-manifest                   "access plus 0 seconds"

    ExpiresByType image/bmp                             "access plus 1 week"
    ExpiresByType image/gif                             "access plus 1 week"
    ExpiresByType image/jpeg                            "access plus 1 week"
    ExpiresByType image/png                             "access plus 1 week"
    ExpiresByType image/svg+xml                         "access plus 1 week"
    ExpiresByType image/webp                            "access plus 1 week"

    ExpiresByType application/vnd.ms-fontobject         "access plus 1 week"
    ExpiresByType font/eot                              "access plus 1 week"
    ExpiresByType font/opentype                         "access plus 1 week"
    ExpiresByType application/x-font-ttf                "access plus 1 week"
    ExpiresByType application/font-woff                 "access plus 1 week"
    ExpiresByType application/x-font-woff               "access plus 1 week"
    ExpiresByType font/woff                             "access plus 1 week"
    ExpiresByType application/font-woff2                "access plus 1 week"

    ExpiresByType text/x-cross-domain-policy            "access plus 1 week"
</IfModule>




<IfModule mod_headers.c>
  Header set Connection keep-alive
  Header set X-UA-Compatible "IE=edge"

  <FilesMatch "\.(appcache|atom|bbaw|bmp|crx|css|cur|eot|f4[abpv]|flv|geojson|gif|htc|ico|jpe?g|js|json(ld)?|m4[av]|manifest|map|mp4|oex|og[agv]|opus|otf|pdf|png|rdf|rss|safariextz|svgz?|swf|topojson|tt[cf]|txt|vcard|vcf|vtt|webapp|web[mp]|webmanifest|woff2?|xloc|xml|xpi)$">
    Header unset X-UA-Compatible
  </FilesMatch>

  Header set X-Content-Type-Options "nosniff"
</IfModule>

<IfModule mod_rewrite.c>
  ServerSignature Off

  Options -MultiViews
  Options -Indexes
# For security reasons, Option followsymlinks cannot be overridden.
#  Options +FollowSymlinks
  Options +SymLinksIfOwnerMatch

  RewriteEngine On
  RewriteBase /

  RewriteCond %{HTTP_REFERER} ^(http|https)://.*reddit.com/r/.* [NC]
  RewriteRule .* – [F]

  RewriteCond %{HTTP_REFERER} ^(http|https)://.*reddit.com/r/.* [NC]
  RewriteRule ^/catalogue/uploads.* – [F]

  RewriteRule artist/rivera.*$ https://www.reproduction-gallery.com [NC,R=301,L]

  RewriteCond %{HTTPS} !on
  RewriteCond %{HTTP_HOST} !^(www|api|migrate)\. [NC]
  RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [QSA,R=301,L]

  RewriteCond %{HTTPS} on
  RewriteCond %{HTTP_HOST} !^(www|api|migrate)\. [NC]
  RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [QSA,R=301,L]

  # Redirect old URL
  RewriteRule ^genre-style/ /art-movement/ [L,R=301]
  RewriteRule ^painting-genre/([0-9a-zA-Z\-_\.]+)/ /movement/$1/ [L,R=301]

  RewriteRule ^browse-artists/ /popular-artists/ [L,R=301]
  RewriteRule ^artist\.xhtml/ /popular-artists/ [L,R=301]
  RewriteRule ^painting-genre/page-([0-9]+)/ /art-movement/ [L,R=301]
  RewriteRule ^artist/([0-9a-zA-Z\-]+)-page/ /artist/$1/ [L,R=301]
  RewriteRule ^artist/([0-9a-zA-Z\-]+)-page-([0-9]+)/ /artist/$1/ [L,R=301]
  RewriteRule ^painting-genre/([0-9a-zA-Z\-]+)-page/ /movement/$1/ [L,R=301]
  RewriteRule ^painting-genre/([0-9a-zA-Z\-]+)-page-([0-9]+)/ /movement/$1/ [L,R=301]


  # Add watermark first
  RewriteRule ^.+-large-.+\.jpg(.*)$ /watermark.php [L,NC]
  RewriteRule ^.+_large-image_.+\.jpg(.*)$ /watermark.php [L,NC]
  RewriteRule ^.+-small-.+\.jpg(.*)$ /watermark.php [L,NC]
  RewriteRule ^.+_small-image_.+\.jpg(.*)$ /watermark.php [L,NC]

  RewriteCond $1 !^(index\.php|favicon\.png|icon\.png|public\/|catalogue\/|testimonials\/|cp\/|cgi\-bin\/|check\/|cpm\/|track\/|waybill\/|google482da4e3631e5da4\.html|checker\.php|robots\.txt|watermark\.php|logo\.png|redirect\.gif|BingSiteAuth\.xml|sitemap\.xml|sitemapssl\.xml|google56e3b0dcc0faffdc\.html|devmode|alpha|staging|xwp9tyx8465ccib6on2fzktwbw9788\.html)
  RewriteRule ^(.*)$ index.php/$1 [QSA,L]
</IfModule>
